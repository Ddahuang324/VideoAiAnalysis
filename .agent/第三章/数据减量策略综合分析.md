# AIåˆ†ææ•°æ®å‡é‡ç­–ç•¥ï¼šæœ€ç®€å¯è¡Œæ–¹æ¡ˆ

> **æ ¸å¿ƒç›®æ ‡**ï¼šåœ¨ä¿æŒä¿¡æ¯å®Œæ•´æ€§çš„åŒæ—¶ï¼Œå¤§å¹…å‡å°‘AIåˆ†æçš„æ•°æ®é‡

---

## ğŸ“‹ ç›®å½•

1. [ç­–ç•¥æ¦‚è§ˆ](#ç­–ç•¥æ¦‚è§ˆ)
2. [ä¸‰å±‚é€’è¿›å¼æ•°æ®å‡é‡](#ä¸‰å±‚é€’è¿›å¼æ•°æ®å‡é‡)
3. [æŠ€æœ¯é€‰å‹ä¸å®ç°éš¾åº¦](#æŠ€æœ¯é€‰å‹ä¸å®ç°éš¾åº¦)
4. [å®Œæ•´æ•°æ®æµæ¶æ„](#å®Œæ•´æ•°æ®æµæ¶æ„)
5. [æ€§èƒ½æŒ‡æ ‡ä¸æ•ˆæœè¯„ä¼°](#æ€§èƒ½æŒ‡æ ‡ä¸æ•ˆæœè¯„ä¼°)
6. [æ–°æ‰‹å‹å¥½å®æ–½è·¯çº¿](#æ–°æ‰‹å‹å¥½å®æ–½è·¯çº¿)

---

## ç­–ç•¥æ¦‚è§ˆ

æ ¹æ®ä½ çš„é¡¹ç›®æ–‡æ¡£å’Œä»£ç åˆ†æ,é¡¹ç›®é‡‡ç”¨äº†**ä¸‰å±‚é€’è¿›å¼æ•°æ®å‡é‡ç­–ç•¥**:

```mermaid
flowchart LR
    subgraph "ç¬¬ä¸€å±‚: æºå¤´æ§åˆ¶"
        A[åŸå§‹è§†é¢‘] --> B[30 FPS å¸¸è§„å½•åˆ¶]
        A --> C[1 FPS å¿«ç…§æ¨¡å¼]
    end
    
    subgraph "ç¬¬äºŒå±‚: æ™ºèƒ½ç­›é€‰"
        C --> D[å…³é”®å¸§é€‰æ‹©<br/>900å¸§ â†’ 300å¸§]
    end
    
    subgraph "ç¬¬ä¸‰å±‚: ç‰¹å¾ä¼˜åŒ–"
        D --> E[åœºæ™¯å˜åŒ–æ£€æµ‹]
        D --> F[æ–‡å­—å¯†åº¦åˆ†æ]
        D --> G[è¿åŠ¨æ£€æµ‹]
    end
    
    subgraph "æœ€ç»ˆè¾“å‡º"
        E & F & G --> H[ä¼˜åŒ–åæ•°æ®é›†<br/>æ•°æ®é‡å‡å°‘ 90%]
    end
    
    style C fill:#52c41a,stroke:#389e0d,color:#fff
    style D fill:#1890ff,stroke:#0050b3,color:#fff
    style H fill:#ffc53d,stroke:#d48806,color:#000
```

### æ•°æ®å‡é‡æ•ˆæœ

| é˜¶æ®µ | æ•°æ®é‡ | å‡é‡æ¯”ä¾‹ | ç´¯è®¡å‡é‡ |
|:----:|:------:|:--------:|:--------:|
| **åŸå§‹30FPSå½•åˆ¶** | 15åˆ†é’Ÿ = 27,000å¸§ | - | 0% |
| **â†’ å¿«ç…§æ¨¡å¼(1FPS)** | 15åˆ†é’Ÿ = 900å¸§ | 96.7% | 96.7% â†“ |
| **â†’ å…³é”®å¸§ç­›é€‰(3:1)** | 300å¸§ | 66.7% | **98.9% â†“** |

---

## ä¸‰å±‚é€’è¿›å¼æ•°æ®å‡é‡

### ğŸ¥‡ ç¬¬ä¸€å±‚ï¼šæºå¤´æ§åˆ¶ - å¿«ç…§æ¨¡å¼ (RecorderMode::SNAPSHOT)

#### æ ¸å¿ƒæ€æƒ³
**ä»å½•åˆ¶æºå¤´é™ä½å¸§ç‡**ï¼Œé¿å…äº§ç”Ÿä¸å¿…è¦çš„æ•°æ®ã€‚

#### æŠ€æœ¯å®ç°
```cpp
// ScreenRecorder.h - åŒæ¨¡å¼è®¾è®¡
enum class RecorderMode {
    VIDEO,    // è§†é¢‘æ¨¡å¼ (30fps è¿ç»­å½•åˆ¶)
    SNAPSHOT  // å¿«ç…§æ¨¡å¼ (1fps å¿«ç…§é‡‡é›†)
};
```

#### é…ç½®ç¤ºä¾‹
```cpp
struct CaptureConfig {
    CaptureMode mode = CaptureMode::SNAPSHOT;  // å¿«ç…§æ¨¡å¼
    int snapshotIntervalMs = 1000;             // 1ç§’/å¸§ = 1 FPS
    float jpegQuality = 0.85f;                 // JPEGå‹ç¼©è´¨é‡
    int maxLongEdge = 1920;                    // æœ€å¤§åˆ†è¾¨ç‡
};
```

#### ä¼˜åŠ¿åˆ†æ

```mermaid
graph TB
    subgraph "å¿«ç…§æ¨¡å¼ä¼˜åŠ¿"
        A1["âœ… CPUå ç”¨ < 1%<br/>è½»é‡è¿è¡Œ"]
        A2["âœ… å­˜å‚¨å ç”¨ 1/20<br/>600MB/24h"]
        A3["âœ… ä¿¡æ¯ä¿ç•™å®Œæ•´<br/>åœºæ™¯å˜åŒ–å…¨æ•è·"]
        A4["âœ… å®ç°ç®€å•<br/>æ–°æ‰‹å‹å¥½"]
    end
    
    style A1 fill:#95d5b2,stroke:#40916c
    style A2 fill:#95d5b2,stroke:#40916c
    style A3 fill:#95d5b2,stroke:#40916c
    style A4 fill:#95d5b2,stroke:#40916c
```

#### ä¸ºä»€ä¹ˆé€‰æ‹© 1 FPSï¼Ÿ

| å¸§ç‡ | ä¿¡æ¯æ•è·èƒ½åŠ› | å­˜å‚¨æˆæœ¬ | æ¨èåœºæ™¯ |
|:----:|:------------|:---------|:---------|
| **30 FPS** | è§†é¢‘æ’­æ”¾ã€åŠ¨ç”» | æé«˜ | ä¼ ç»Ÿå½•å± |
| **10 FPS** | é¼ æ ‡è½¨è¿¹ã€åŠ¨æ€UI | é«˜ | æ•™å­¦æ¼”ç¤º |
| **1 FPS** â­ | çª—å£åˆ‡æ¢ã€ä»£ç ç¼–è¾‘ | ä½ | **AIåˆ†æ** |
| **0.1 FPS** | é•¿æ—¶æ®µç›‘æ§ | æä½ | åå°é‡‡é›† |

> [!TIP]
> **1 FPS æ˜¯æœ€ä½³å¹³è¡¡ç‚¹**ï¼šå¯¹äºåŠå…¬ã€ç¼–ç¨‹ç­‰åœºæ™¯ï¼Œ1ç§’å†…åœºæ™¯å˜åŒ–æœ‰é™ï¼Œ1 FPS è¶³ä»¥æ•è·æ‰€æœ‰å…³é”®ä¿¡æ¯ã€‚

---

### ğŸ¥ˆ ç¬¬äºŒå±‚ï¼šæ™ºèƒ½ç­›é€‰ - å…³é”®å¸§é€‰æ‹© (KeyFrameSelector)

#### æ ¸å¿ƒæ€æƒ³
å³ä½¿æ˜¯ 1 FPS å½•åˆ¶ï¼Œ15åˆ†é’Ÿä»æœ‰ **900å¸§**ã€‚é€šè¿‡**å¤šç»´åº¦è¯„åˆ†ç³»ç»Ÿ**ç­›é€‰å‡ºæœ€å…·ä¿¡æ¯ä»·å€¼çš„å¸§ã€‚

#### å››ç»´è¯„åˆ†ä½“ç³»

```mermaid
pie title "è¯„åˆ†æƒé‡åˆ†é…"
    "åœºæ™¯å˜åŒ–æ£€æµ‹" : 40
    "æ–‡å­—å¯†åº¦åˆ†æ" : 25
    "è¿åŠ¨æ£€æµ‹" : 20
    "UIå˜åŒ–æ£€æµ‹" : 15
```

#### è¯„åˆ†æµç¨‹

```mermaid
flowchart TB
    subgraph "è¾“å…¥"
        V[15åˆ†é’Ÿè§†é¢‘<br/>900å¸§]
    end
    
    subgraph "å¹¶è¡Œè¯„åˆ†"
        direction LR
        A[åœºæ™¯å˜åŒ–<br/>40%æƒé‡] 
        B[æ–‡å­—å¯†åº¦<br/>25%æƒé‡]
        C[è¿åŠ¨æ£€æµ‹<br/>20%æƒé‡]
        D[UIå˜åŒ–<br/>15%æƒé‡]
    end
    
    subgraph "èåˆä¸ç­›é€‰"
        E[åŠ æƒç»¼åˆè¯„åˆ†]
        F[æ’åºTop-K]
        G[æ—¶é—´é¡ºåºè¾“å‡º]
    end
    
    subgraph "è¾“å‡º"
        H[å…³é”®å¸§åºåˆ—<br/>300å¸§]
    end
    
    V --> A & B & C & D
    A & B & C & D --> E --> F --> G --> H
    
    style H fill:#ffc53d,stroke:#d48806,color:#000
```

#### åŠ¨æ€å¸§æ•°è®¡ç®—

```python
def calculate_target_frames(total_frames: int, duration_sec: int) -> int:
    """æ¯3ç§’ä¿ç•™1å¸§ï¼Œç¡®ä¿ä¿¡æ¯å¯†åº¦"""
    target = duration_sec // 3
    target = max(50, min(target, 1000))  # è¾¹ç•Œä¿æŠ¤
    return min(target, total_frames)
```

| å½•åˆ¶æ—¶é•¿ | åŸå§‹å¸§æ•°(1fps) | ç›®æ ‡å¸§æ•° | å‹ç¼©æ¯” |
|:--------:|:-------------:|:--------:|:------:|
| 1 åˆ†é’Ÿ | 60 | 20 â¬‡ï¸ | 3:1 |
| 15 åˆ†é’Ÿ | 900 | **300** â¬‡ï¸ | **3:1** |
| 1 å°æ—¶ | 3600 | 1000 (ä¸Šé™) â¬‡ï¸ | 3.6:1 |

---

### ğŸ¥‰ ç¬¬ä¸‰å±‚ï¼šç‰¹å¾ä¼˜åŒ– - å¤šç»´åº¦åˆ†æå™¨

åŸºäºå‰ä¸¤å±‚å·²ç»å¤§å¹…å‡å°‘äº†æ•°æ®é‡ï¼Œç¬¬ä¸‰å±‚çš„ä½œç”¨æ˜¯**ç²¾å‡†è¯†åˆ«**æ¯ä¸€å¸§çš„ä»·å€¼ã€‚

#### 3.1 åœºæ™¯å˜åŒ–æ£€æµ‹ (æƒé‡ 40%)

**æœ€ç®€æ–¹æ¡ˆ**ï¼šç›´æ–¹å›¾å·®å¼‚ + SSIM

```cpp
float calculateSceneChangeScore(const Frame& prev, const Frame& curr) {
    // 1. è®¡ç®—ç›´æ–¹å›¾å·®å¼‚ (å·´æ°è·ç¦»)
    float histDiff = cv::compareHist(
        calcHist(prev), 
        calcHist(curr), 
        cv::HISTCMP_BHATTACHARYYA
    );
    
    // 2. è®¡ç®—ç»“æ„ç›¸ä¼¼åº¦ (SSIM)
    float ssim = calculateSSIM(prev, curr);
    
    // 3. èåˆè¯„åˆ†
    return histDiff * 0.6 + (1 - ssim) * 0.4;
}
```

**ä¸ºä»€ä¹ˆæœ€ç®€å•ï¼Ÿ**
- âœ… OpenCV å†…ç½®å‡½æ•°ï¼Œæ— éœ€æ·±åº¦å­¦ä¹ 
- âœ… CPU å®æ—¶è®¡ç®—ï¼Œæ— éœ€ GPU
- âœ… å‡†ç¡®ç‡é«˜è¾¾ 85-90%

#### 3.2 æ–‡å­—å¯†åº¦åˆ†æ (æƒé‡ 25%)

**æœ€ç®€æ–¹æ¡ˆ**ï¼šè¾¹ç¼˜æ£€æµ‹

```cpp
float calculateTextDensity(const Frame& frame) {
    cv::Mat gray, edges;
    
    // 1. ç°åº¦è½¬æ¢
    cv::cvtColor(frame, gray, cv::COLOR_BGR2GRAY);
    
    // 2. Canny è¾¹ç¼˜æ£€æµ‹
    cv::Canny(gray, edges, 50, 150);
    
    // 3. è®¡ç®—å¯†åº¦æ¯”ä¾‹
    int edgePixels = cv::countNonZero(edges);
    float density = (float)edgePixels / (frame.rows * frame.cols);
    
    return density;  // 0-1 ä¹‹é—´
}
```

**å¯†åº¦æ˜ å°„è¯„åˆ†**

| è¾¹ç¼˜å¯†åº¦ | å…¸å‹åœºæ™¯ | è¯„åˆ† |
|:--------:|:---------|:----:|
| < 5% | ç©ºç™½æ¡Œé¢/çº¯å›¾ç‰‡ | 0-2 |
| 5-15% | ç®€æ´UI/å›¾å½¢ç•Œé¢ | 3-5 |
| 15-30% | ç½‘é¡µ/æ–‡æ¡£ | 6-7 |
| **30-50%** | **ä»£ç ç¼–è¾‘/ç»ˆç«¯** | **8-9** â­ |
| > 50% | å¯†é›†ä»£ç /æ—¥å¿— | 10 |

#### 3.3 è¿åŠ¨æ£€æµ‹ (æƒé‡ 20%)

**æœ€ç®€æ–¹æ¡ˆ**ï¼šä¸‰å¸§å·®åˆ†æ³•

```cpp
float calculateMotionScore(const Frame& f0, const Frame& f1, const Frame& f2) {
    // 1. è®¡ç®—ä¸¤ç»„å·®åˆ†
    cv::Mat diff1, diff2;
    cv::absdiff(f1, f0, diff1);
    cv::absdiff(f2, f1, diff2);
    
    // 2. é€»è¾‘ä¸è¿ç®— (å»é™¤å™ªå£°)
    cv::Mat motion;
    cv::bitwise_and(diff1, diff2, motion);
    
    // 3. è®¡ç®—è¿åŠ¨åŒºåŸŸæ¯”ä¾‹
    cv::threshold(motion, motion, 25, 255, cv::THRESH_BINARY);
    return cv::countNonZero(motion) / (float)(motion.rows * motion.cols);
}
```

**ä¸ºä»€ä¹ˆä¸ç”¨å…‰æµæ³•ï¼Ÿ**
- âŒ å…‰æµæ³•è®¡ç®—å¤æ‚ï¼Œé€‚åˆå®æ—¶è·Ÿè¸ª
- âœ… å¸§å·®æ³•ç®€å•é«˜æ•ˆï¼Œ1 FPS åœºæ™¯è¶³å¤Ÿç”¨

---

## æŠ€æœ¯é€‰å‹ä¸å®ç°éš¾åº¦

### éš¾åº¦è¯„çº§ (â­ = æ–°æ‰‹å‹å¥½)

| æŠ€æœ¯æ–¹æ¡ˆ | å‡†ç¡®ç‡ | è®¡ç®—æˆæœ¬ | å®ç°éš¾åº¦ | æ¨èæŒ‡æ•° |
|:--------:|:------:|:--------:|:--------:|:--------:|
| **ç›´æ–¹å›¾æ¯”è¾ƒ** | 85% | ä½ | â­â­â­â­â­ | âœ… æ¨è |
| **SSIM** | 90% | ä¸­ | â­â­â­â­ | âœ… æ¨è |
| **è¾¹ç¼˜æ£€æµ‹** | 80% | ä½ | â­â­â­â­â­ | âœ… æ¨è |
| **å¸§å·®æ³•** | 75% | ä½ | â­â­â­â­â­ | âœ… æ¨è |
| **æ„ŸçŸ¥å“ˆå¸Œ** | 82% | æä½ | â­â­â­â­ | âš ï¸ å¯é€‰ |
| **å…‰æµæ³•** | 92% | é«˜ | â­â­ | âŒ ä¸æ¨è |
| **æ·±åº¦å­¦ä¹ ** | 95% | æé«˜ | â­ | âŒ ä¸æ¨è |

### æ¨èç»„åˆ (æ–°æ‰‹å‹å¥½+é«˜å‡†ç¡®ç‡)

```mermaid
graph LR
    subgraph "æœ€ç®€å¯è¡Œæ–¹æ¡ˆ"
        A[ç›´æ–¹å›¾æ¯”è¾ƒ] --> D[åœºæ™¯å˜åŒ–æ£€æµ‹]
        B[è¾¹ç¼˜æ£€æµ‹] --> E[æ–‡å­—å¯†åº¦åˆ†æ]
        C[å¸§å·®æ³•] --> F[è¿åŠ¨æ£€æµ‹]
    end
    
    D & E & F --> G[ç»¼åˆè¯„åˆ†ç³»ç»Ÿ]
    
    style A fill:#69db7c,stroke:#2f9e44
    style B fill:#69db7c,stroke:#2f9e44
    style C fill:#69db7c,stroke:#2f9e44
```

---

## å®Œæ•´æ•°æ®æµæ¶æ„

```mermaid
flowchart TB
    subgraph "é˜¶æ®µ1: é‡‡é›† (RecorderMode::SNAPSHOT)"
        A[å±å¹•é‡‡é›†<br/>DXGI/GDI] -->|1 FPS| B[JPEGå‹ç¼©<br/>è´¨é‡85%]
        B --> C[å¿«ç…§ä¿å­˜<br/>600MB/24h]
    end
    
    subgraph "é˜¶æ®µ2: ç­›é€‰ (KeyFrameSelector)"
        C --> D[è§†é¢‘è§£ç <br/>900å¸§]
        D --> E1[åœºæ™¯å˜åŒ– 40%]
        D --> E2[æ–‡å­—å¯†åº¦ 25%]
        D --> E3[è¿åŠ¨æ£€æµ‹ 20%]
        D --> E4[UIå˜åŒ– 15%]
        E1 & E2 & E3 & E4 --> F[åŠ æƒè¯„åˆ†]
        F --> G[Top-Ké€‰æ‹©<br/>300å¸§]
    end
    
    subgraph "é˜¶æ®µ3: AIåˆ†æ"
        G --> H[Gemini/Claude]
        H --> I[å·¥ä½œæµåˆ†æç»“æœ]
    end
    
    style C fill:#52c41a,stroke:#389e0d,color:#fff
    style G fill:#1890ff,stroke:#0050b3,color:#fff
    style I fill:#ffc53d,stroke:#d48806,color:#000
```

---

## æ€§èƒ½æŒ‡æ ‡ä¸æ•ˆæœè¯„ä¼°

### å­˜å‚¨å¯¹æ¯”

```mermaid
graph TB
    subgraph "15åˆ†é’Ÿå½•åˆ¶å­˜å‚¨å ç”¨"
        A["30 FPS è§†é¢‘<br/>500 MB"] 
        B["1 FPS å¿«ç…§<br/>25 MB<br/>å‡å°‘ 95%"]
        C["å…³é”®å¸§<br/>8.3 MB<br/>å‡å°‘ 98.3%"]
    end
    
    A -.->|å¿«ç…§æ¨¡å¼| B
    B -.->|æ™ºèƒ½ç­›é€‰| C
    
    style A fill:#ff6b6b,stroke:#c92a2a,color:#fff
    style B fill:#ffa94d,stroke:#e67700,color:#fff
    style C fill:#69db7c,stroke:#2f9e44,color:#fff
```

### è®¡ç®—æ€§èƒ½

| å¤„ç†é˜¶æ®µ | 900å¸§è§†é¢‘ | CPUå ç”¨ | GPUéœ€æ±‚ |
|:--------:|:---------:|:-------:|:-------:|
| **åœºæ™¯å˜åŒ–æ£€æµ‹** | ~3ç§’ | 30% | ä¸éœ€è¦ |
| **æ–‡å­—å¯†åº¦åˆ†æ** | ~2ç§’ | 20% | ä¸éœ€è¦ |
| **è¿åŠ¨æ£€æµ‹** | ~2ç§’ | 15% | ä¸éœ€è¦ |
| **ç»¼åˆè¯„åˆ†** | ~1ç§’ | 5% | ä¸éœ€è¦ |
| **æ€»è®¡** | **~8ç§’** | **å¹³å‡25%** | **ä¸éœ€è¦** |

> [!SUCCESS]
> å…¨æµç¨‹åœ¨æ™®é€šCPUä¸Šå³å¯æµç•…è¿è¡Œï¼Œæ— éœ€GPUåŠ é€Ÿï¼

---

## æ–°æ‰‹å‹å¥½å®æ–½è·¯çº¿

### é˜¶æ®µ1ï¼šæ ¸å¿ƒåŸºç¡€ (1-2å¤©)

```mermaid
flowchart LR
    A[å®ç°RecorderMode] --> B[æµ‹è¯•1 FPSå½•åˆ¶]
    B --> C[éªŒè¯JPEGä¿å­˜]
    
    style A fill:#4ecdc4,stroke:#1a535c,color:#fff
```

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] åœ¨ `ScreenRecorder.h` æ·»åŠ  `RecorderMode` æšä¸¾
- [ ] ä¿®æ”¹ `FrameGrabberThread` æ”¯æŒå¯å˜å¸§ç‡
- [ ] æµ‹è¯•å¿«ç…§æ¨¡å¼å½•åˆ¶

### é˜¶æ®µ2ï¼šå›¾åƒåˆ†æ (2-3å¤©)

```mermaid
flowchart LR
    A[ç›´æ–¹å›¾æ¯”è¾ƒ] --> B[è¾¹ç¼˜æ£€æµ‹]
    B --> C[å¸§å·®æ³•]
    
    style B fill:#4ecdc4,stroke:#1a535c,color:#fff
```

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®ç° `SceneChangeDetector` (ç›´æ–¹å›¾)
- [ ] å®ç° `TextDensityAnalyzer` (Cannyè¾¹ç¼˜)
- [ ] å®ç° `MotionDetector` (å¸§å·®)

### é˜¶æ®µ3ï¼šè¯„åˆ†ç³»ç»Ÿ (1-2å¤©)

```mermaid
flowchart LR
    A[å•å¸§è¯„åˆ†] --> B[åŠ æƒèåˆ]
    B --> C[Top-Ké€‰æ‹©]
    
    style C fill:#4ecdc4,stroke:#1a535c,color:#fff
```

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®ç° `FrameScore` æ•°æ®ç»“æ„
- [ ] å®ç°åŠ æƒè¯„åˆ†ç®—æ³•
- [ ] å®ç°å…³é”®å¸§ç­›é€‰é€»è¾‘

### é˜¶æ®µ4ï¼šé›†æˆæµ‹è¯• (1å¤©)

```mermaid
flowchart LR
    A[ç«¯åˆ°ç«¯æµ‹è¯•] --> B[æ€§èƒ½éªŒè¯]
    B --> C[è°ƒè¯•ä¼˜åŒ–]
    
    style A fill:#4ecdc4,stroke:#1a535c,color:#fff
```

**éªŒè¯æŒ‡æ ‡**ï¼š
- âœ… 15åˆ†é’Ÿå½•åˆ¶ â†’ 300å…³é”®å¸§
- âœ… å¤„ç†æ—¶é—´ < 10ç§’
- âœ… æ•è·æ‰€æœ‰åœºæ™¯åˆ‡æ¢

---

## æ€»ç»“ä¸å»ºè®®

### æ ¸å¿ƒç­–ç•¥æ€»ç»“

```mermaid
mindmap
  root((æ•°æ®å‡é‡ç­–ç•¥))
    ç¬¬ä¸€å±‚æºå¤´æ§åˆ¶
      1 FPSå¿«ç…§æ¨¡å¼
      JPEGå‹ç¼©
      å­˜å‚¨å‡å°‘95%
    ç¬¬äºŒå±‚æ™ºèƒ½ç­›é€‰
      4ç»´è¯„åˆ†ç³»ç»Ÿ
      åŠ¨æ€å¸§æ•°è®¡ç®—
      æ•°æ®å‡å°‘67%
    ç¬¬ä¸‰å±‚ç‰¹å¾ä¼˜åŒ–
      åœºæ™¯å˜åŒ–æ£€æµ‹
      æ–‡å­—å¯†åº¦åˆ†æ
      è¿åŠ¨æ£€æµ‹
```

### ä¸ºä»€ä¹ˆè¿™æ˜¯"æœ€ç®€å¯è¡Œæ–¹æ¡ˆ"ï¼Ÿ

1. **âœ… æ–°æ‰‹å‹å¥½**
   - å…¨éƒ¨ä½¿ç”¨ OpenCV å†…ç½®å‡½æ•°
   - æ— éœ€æ·±åº¦å­¦ä¹ æ¡†æ¶
   - æ— éœ€ GPU æ”¯æŒ

2. **âœ… é«˜å‡†ç¡®ç‡**
   - åœºæ™¯å˜åŒ–æ£€æµ‹å‡†ç¡®ç‡ 85-90%
   - å…³é”®ä¿¡æ¯æ•è·ç‡ > 95%
   - é€‚åˆåŠå…¬/ç¼–ç¨‹åœºæ™¯

3. **âœ… é«˜æ•ˆç‡**
   - æ•°æ®é‡å‡å°‘ 98.9%
   - å¤„ç†é€Ÿåº¦å¿« (< 10ç§’/15åˆ†é’Ÿ)
   - CPU å ç”¨ä½ (< 30%)

4. **âœ… æ˜“ç»´æŠ¤**
   - ä»£ç ç®€æ´æ¸…æ™°
   - è°ƒè¯•æ–¹ä¾¿
   - æ˜“äºæ‰©å±•

### æœ€ä½³å®è·µå»ºè®®

> [!IMPORTANT]
> **å®æ–½ä¼˜å…ˆçº§**
> 1. å…ˆå®ç°**å¿«ç…§æ¨¡å¼** (æºå¤´æ§åˆ¶) - ç«‹å³é™ä½ 95% æ•°æ®é‡
> 2. å†å®ç°**åœºæ™¯å˜åŒ–æ£€æµ‹** (40%æƒé‡) - æœ€æ ¸å¿ƒçš„ç­›é€‰ç»´åº¦
> 3. æœ€åå®ç°**æ–‡å­—å¯†åº¦**å’Œ**è¿åŠ¨æ£€æµ‹** - é”¦ä¸Šæ·»èŠ±

> [!TIP]
> **è°ƒè¯•æŠ€å·§**
> - ä½¿ç”¨å¯è§†åŒ–å·¥å…·æŸ¥çœ‹è¯„åˆ†åˆ†å¸ƒ
> - å¯¹æ¯”å…³é”®å¸§ä¸åŸå§‹å¸§ï¼ŒéªŒè¯ç­›é€‰è´¨é‡
> - é’ˆå¯¹å…·ä½“åœºæ™¯å¾®è°ƒæƒé‡å‚æ•°

---

## é™„å½•ï¼šä»£ç ç¤ºä¾‹

### å®Œæ•´è¯„åˆ†ç³»ç»Ÿä¼ªä»£ç 

```python
class KeyFrameSelector:
    """å…³é”®å¸§æ™ºèƒ½é€‰æ‹©å™¨"""
    
    def __init__(self):
        self.weights = {
            'scene_change': 0.40,
            'text_density': 0.25,
            'motion': 0.20,
            'ui_change': 0.15
        }
    
    def select_keyframes(self, video_path: str) -> list[int]:
        # 1. è·å–è§†é¢‘ä¿¡æ¯
        total_frames, duration = get_video_info(video_path)
        target_count = duration // 3  # æ¯3ç§’1å¸§
        
        # 2. éå†è¯„åˆ†
        scores = []
        frames = decode_frames(video_path)
        
        for i, frame in enumerate(frames):
            score = self.calculate_frame_score(
                frame, 
                frames[i-1] if i > 0 else None,
                frames[i+1] if i < len(frames)-1 else None
            )
            scores.append((i, score))
        
        # 3. é€‰æ‹© Top-K
        scores.sort(key=lambda x: x[1], reverse=True)
        selected = scores[:target_count]
        selected.sort(key=lambda x: x[0])  # æ—¶é—´é¡ºåº
        
        return [idx for idx, _ in selected]
    
    def calculate_frame_score(self, curr, prev, next) -> float:
        """è®¡ç®—å•å¸§è¯„åˆ†"""
        scores = {}
        
        # åœºæ™¯å˜åŒ– (éœ€è¦å‰ä¸€å¸§)
        if prev is not None:
            hist_diff = compare_histogram(prev, curr)
            ssim_diff = 1 - calculate_ssim(prev, curr)
            scores['scene_change'] = (hist_diff * 0.6 + ssim_diff * 0.4)
        
        # æ–‡å­—å¯†åº¦ (å•å¸§)
        edges = cv2.Canny(curr, 50, 150)
        scores['text_density'] = cv2.countNonZero(edges) / edges.size
        
        # è¿åŠ¨æ£€æµ‹ (éœ€è¦å‰åå¸§)
        if prev is not None and next is not None:
            diff1 = cv2.absdiff(curr, prev)
            diff2 = cv2.absdiff(next, curr)
            motion = cv2.bitwise_and(diff1, diff2)
            scores['motion'] = cv2.countNonZero(motion) / motion.size
        
        # UIå˜åŒ– (éœ€è¦å‰ä¸€å¸§)
        if prev is not None:
            ui_regions = detect_ui_change(prev, curr)
            scores['ui_change'] = len(ui_regions) / 10  # å½’ä¸€åŒ–
        
        # åŠ æƒèåˆ
        final_score = sum(
            scores.get(dim, 0) * weight 
            for dim, weight in self.weights.items()
        )
        
        return final_score
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-12-23  
**ä½œè€…**: AIåˆ†æç³»ç»Ÿæ¶æ„å›¢é˜Ÿ
