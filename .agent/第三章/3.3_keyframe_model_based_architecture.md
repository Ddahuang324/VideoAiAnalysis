# 3.3 ä¸‰ç»´å…³é”®å¸§æ™ºèƒ½é€‰æ‹©æ¶æ„è®¾è®¡ï¼ˆæ¨¡å‹é©±åŠ¨ç‰ˆï¼‰

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°å°†å…³é”®å¸§é€‰æ‹©æ¨¡å—ä»ä¼ ç»Ÿå›¾åƒç®—æ³•**å‡çº§ä¸º2025å¹´æ·±åº¦å­¦ä¹ æ¨¡å‹é©±åŠ¨æ–¹æ¡ˆ**çš„æ¶æ„è®¾è®¡ã€‚é€šè¿‡å¼•å…¥ MobileNetV3-Smallã€YOLOv8n + ByteTrack å’Œ PaddleOCR PP-OCRv4ï¼Œå®ç°æ›´ç²¾å‡†ã€æ›´å…·è¯­ä¹‰ç†è§£èƒ½åŠ›çš„å…³é”®å¸§ç­›é€‰ã€‚

---

## å¯è¡Œæ€§åˆ†æ

### æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”

````carousel
### åŸæ–¹æ¡ˆ vs æ–°æ–¹æ¡ˆï¼šåœºæ™¯å˜åŒ–æ£€æµ‹

| ç»´åº¦ | åŸæ–¹æ¡ˆ | æ–°æ–¹æ¡ˆ |
|:----:|:------|:------|
| **æŠ€æœ¯** | ç›´æ–¹å›¾ + SSIM | MobileNetV3-Small + ç›´æ–¹å›¾ |
| **ç‰¹ç‚¹** | åƒç´ çº§æ¯”è¾ƒ | è¯­ä¹‰çº§ç‰¹å¾æå– |
| **ä¼˜åŠ¿** | è®¡ç®—å¿«é€Ÿ (5ms) | ç†è§£åœºæ™¯ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ |
| **åŠ£åŠ¿** | æ— æ³•åŒºåˆ†è¯­ä¹‰ç›¸ä¼¼åœºæ™¯ | éœ€è¦æ¨¡å‹æ¨ç† |

<!-- slide -->
### åŸæ–¹æ¡ˆ vs æ–°æ–¹æ¡ˆï¼šè¿åŠ¨æ£€æµ‹

| ç»´åº¦ | åŸæ–¹æ¡ˆ | æ–°æ–¹æ¡ˆ |
|:----:|:------|:------|
| **æŠ€æœ¯** | ä¸‰å¸§å·®åˆ†æ³• | YOLOv8n + ByteTrack |
| **ç‰¹ç‚¹** | å…¨å±€åƒç´ å˜åŒ– | ç›®æ ‡çº§è·Ÿè¸ª |
| **ä¼˜åŠ¿** | å®ç°ç®€å• | ç²¾ç¡®è¯†åˆ«ç‰©ä½“ç§»åŠ¨ |
| **åŠ£åŠ¿** | æ— æ³•åŒºåˆ†ç›®æ ‡ | éœ€è¦GPUåŠ é€Ÿ |

<!-- slide -->
### åŸæ–¹æ¡ˆ vs æ–°æ–¹æ¡ˆï¼šæ–‡å­—æ£€æµ‹

| ç»´åº¦ | åŸæ–¹æ¡ˆ | æ–°æ–¹æ¡ˆ |
|:----:|:------|:------|
| **æŠ€æœ¯** | Cannyè¾¹ç¼˜å¯†åº¦ | PaddleOCR PP-OCRv4 |
| **ç‰¹ç‚¹** | è¾¹ç¼˜åƒç´ ç»Ÿè®¡ | ç«¯åˆ°ç«¯æ–‡å­—è¯†åˆ« |
| **ä¼˜åŠ¿** | æå¿« (<10ms) | è·å–å®é™…æ–‡å­—å†…å®¹ |
| **åŠ£åŠ¿** | è¯¯å°†UIè¾¹æ¡†è®¡å…¥ | æ¨ç†è€—æ—¶è¾ƒé•¿ |
````

---

## å¯è¡Œæ€§ç»“è®º

> [!IMPORTANT]
> **ç»“è®ºï¼šæ–¹æ¡ˆå¯è¡Œ**ï¼Œä½†éœ€é‡‡ç”¨**æ··åˆç­–ç•¥**ä»¥å¹³è¡¡ç²¾åº¦ä¸æ€§èƒ½ã€‚

### å¯è¡Œæ€§è¯„ä¼°çŸ©é˜µ

| è¯„ä¼°é¡¹ | è¯„åˆ† | è¯´æ˜ |
|:------:|:----:|:-----|
| æŠ€æœ¯æˆç†Ÿåº¦ | â­â­â­â­â­ | æ‰€æœ‰æ¨¡å‹å‡ä¸ºæˆç†Ÿå¼€æºé¡¹ç›® |
| C++ é›†æˆéš¾åº¦ | â­â­â­â­ | ONNX Runtime / TensorRT æ”¯æŒè‰¯å¥½ |
| æ€§èƒ½å¯æ¥å—åº¦ | â­â­â­â­ | éœ€ GPU åŠ é€Ÿï¼Œæ‰¹å¤„ç†ä¼˜åŒ– |
| ç²¾åº¦æå‡é¢„æœŸ | â­â­â­â­â­ | è¯­ä¹‰ç†è§£æ˜¾è‘—ä¼˜äºåƒç´ æ¯”è¾ƒ |
| ç»´æŠ¤å¤æ‚åº¦ | â­â­â­ | æ¨¡å‹ç‰ˆæœ¬æ›´æ–°éœ€åŒæ­¥ |

---

## ç³»ç»Ÿæ¶æ„æ€»è§ˆ

```mermaid
flowchart TB
    subgraph Input["ğŸ“¥ è¾“å…¥å±‚"]
        MP4["MP4 è§†é¢‘æ–‡ä»¶<br/>900 å¸§ @ 1fps"]
    end
    
    subgraph Decoder["ğŸ”“ è§£ç å±‚"]
        FFD["FFmpeg è§£ç å™¨"]
        FrameBuffer["å¸§ç¼“å†²é˜Ÿåˆ—"]
    end
    
    subgraph PreFilter["âš¡ é¢„ç­›é€‰å±‚"]
        direction LR
        FastHist["å¿«é€Ÿç›´æ–¹å›¾<br/>åˆç­›"]
        Skip["è·³è¿‡é™æ€å¸§"]
    end
    
    subgraph Analyzer["ğŸ§  æ¨¡å‹åˆ†æå¼•æ“"]
        direction TB
        SC["åœºæ™¯å˜åŒ–æ£€æµ‹å™¨<br/>MobileNetV3-Small<br/>æƒé‡åŠ¨æ€"]
        MD["è¿åŠ¨æ£€æµ‹å™¨<br/>YOLOv8n + ByteTrack<br/>æƒé‡åŠ¨æ€"]
        OCR["æ–‡å­—æ£€æµ‹å™¨<br/>PP-OCRv4<br/>æƒé‡åŠ¨æ€"]
    end
    
    subgraph Scorer["ğŸ“Š è¯„åˆ†ç³»ç»Ÿ"]
        Calculator["ç»¼åˆè¯„åˆ†è®¡ç®—å™¨"]
        Ranker["å¸§æ’åºå™¨"]
        Selector["Top-K é€‰æ‹©å™¨"]
    end
    
    subgraph Output["ğŸ“¤ è¾“å‡ºå±‚"]
        KF["å…³é”®å¸§åºåˆ—<br/>~300 å¸§"]
        NewMP4["ä¼˜åŒ–åè§†é¢‘"]
    end
    
    MP4 --> FFD --> FrameBuffer
    FrameBuffer --> PreFilter
    PreFilter -->|å€™é€‰å¸§| SC & MD & OCR
    PreFilter -->|é™æ€å¸§| Skip
    SC & MD & OCR --> Calculator
    Calculator --> Ranker --> Selector --> KF --> NewMP4
```

---

## ä¸‰ç»´è¯„åˆ†ä½“ç³»

### ç»´åº¦åŠŸèƒ½å®šä¹‰

```mermaid
flowchart LR
    subgraph Scene["ğŸ¬ åœºæ™¯å˜åŒ– (Scene)"]
        S1["MobileNetV3-Small"]
        S2["ä¼ ç»Ÿç›´æ–¹å›¾"]
        S3["å…¨å›¾åƒç´ ä½™å¼¦ç›¸ä¼¼åº¦"]
    end
    
    subgraph Motion["ğŸ¯ è¿åŠ¨æ£€æµ‹ (Motion)"]
        M1["YOLOv8n æ£€æµ‹"]
        M2["ByteTrack è·Ÿè¸ª"]
        M3["ä½ç§»å¼ºåº¦è®¡ç®—"]
    end
    
    subgraph TextOCR["ğŸ“ æ–‡å­—æ£€æµ‹ (OCR)"]
        T1["PP-OCRv4 è¯†åˆ«"]
        T2["æ–‡å­—ç½®ä¿¡åº¦"]
        T3["æ–‡å­—åˆ†å¸ƒå¯†åº¦"]
    end
    
    S1 --> S2 --> S3
    M1 --> M2 --> M3
    T1 --> T2 --> T3
```

### ç»´åº¦æƒé‡ä¸åŠŸèƒ½è¯´æ˜

| ç»´åº¦ | æ¨¡å‹æŠ€æœ¯æ ˆ | è¯„åˆ†æŒ‡æ ‡ | åŠŸèƒ½å®šä½ | é¢„æœŸå»¶è¿Ÿ |
|:----:|:----------|:---------|:---------|:--------:|
| **åœºæ™¯å˜åŒ–** | MobileNetV3-Small + ç›´æ–¹å›¾ | ä½™å¼¦ç›¸ä¼¼åº¦ ($S$) | **å¼€å…³/é‡ç½®ä½**ï¼šç›¸ä¼¼åº¦ä½äºé˜ˆå€¼æ—¶è§¦å‘ç³»ç»Ÿé‡ç½® | 5-10ms |
| **è¿åŠ¨æ£€æµ‹** | YOLOv8n + ByteTrack | ä½ç§»å¼ºåº¦ ($M$) + ç½®ä¿¡åº¦ | **å¼•å¯¼ä½**ï¼šç¡®å®š"å“ªé‡Œæœ‰ä»·å€¼"ï¼Œè¿åŠ¨è¶Šå‰§çƒˆæƒé‡è¶Šé«˜ | 15-30ms |
| **æ–‡å­—æ£€æµ‹** | PaddleOCR PP-OCRv4 | ç½®ä¿¡åº¦ ($T$) + åˆ†å¸ƒå¯†åº¦ | **æ ¸å¿ƒè¯­ä¹‰ä½**ï¼šå†³å®šæœ€ç»ˆä¿¡æ¯è´¨é‡ï¼Œæƒé‡æœ€é«˜ | 50-100ms |

---

## æ¨¡å—è¯¦ç»†è®¾è®¡

### 3.3.1 åœºæ™¯å˜åŒ–æ£€æµ‹æ¨¡å—

> [!NOTE]
> åœºæ™¯å˜åŒ–æ¨¡å—é‡‡ç”¨**æ··åˆç­–ç•¥**ï¼šMobileNetV3-Small æå–æ·±åº¦ç‰¹å¾ï¼Œç»“åˆä¼ ç»Ÿç›´æ–¹å›¾ä½œä¸ºåº•å™ªåŸºå‡†ã€‚

```mermaid
flowchart TB
    subgraph Input["è¾“å…¥"]
        Frame["å½“å‰å¸§"]
        PrevFrame["å‰ä¸€å¸§"]
    end
    
    subgraph MobileNet["MobileNetV3-Small ç‰¹å¾æå–"]
        Backbone["Backbone<br/>æ·±åº¦å¯åˆ†ç¦»å·ç§¯"]
        Pool["Global Avg Pool"]
        Feature["1280ç»´ç‰¹å¾å‘é‡"]
    end
    
    subgraph Traditional["ä¼ ç»Ÿç›´æ–¹å›¾"]
        Hist["RGBç›´æ–¹å›¾"]
        Bhatta["å·´æ°è·ç¦»"]
    end
    
    subgraph Fusion["èåˆå†³ç­–"]
        Cosine["ä½™å¼¦ç›¸ä¼¼åº¦"]
        Weighted["åŠ æƒèåˆ<br/>Î±=0.7, Î²=0.3"]
        Score["åœºæ™¯å˜åŒ–åˆ†æ•° S"]
    end
    
    Frame --> Backbone --> Pool --> Feature
    PrevFrame --> Backbone
    Feature --> Cosine
    
    Frame --> Hist --> Bhatta
    PrevFrame --> Hist
    
    Cosine --> Weighted
    Bhatta --> Weighted
    Weighted --> Score
```

#### æ ¸å¿ƒç®—æ³•

```cpp
class SceneChangeDetector {
public:
    struct Config {
        float modelWeight = 0.7f;      // MobileNetç‰¹å¾æƒé‡
        float histogramWeight = 0.3f;  // ä¼ ç»Ÿç›´æ–¹å›¾æƒé‡
        float resetThreshold = 0.35f;  // é‡ç½®é˜ˆå€¼
    };
    
    float calculateScore(const Frame& prev, const Frame& curr) {
        // 1. MobileNetV3-Small ç‰¹å¾æå–
        auto prevFeature = mobileNet_.extractFeature(prev);  // [1280]
        auto currFeature = mobileNet_.extractFeature(curr);  // [1280]
        
        // 2. è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
        float cosineSim = cosineSimilarity(prevFeature, currFeature);
        float modelDiff = 1.0f - cosineSim;
        
        // 3. ä¼ ç»Ÿç›´æ–¹å›¾å·®å¼‚ï¼ˆåº•å™ªåŸºå‡†ï¼‰
        float histDiff = compareHistograms(prev, curr, CV_COMP_BHATTACHARYYA);
        
        // 4. åŠ æƒèåˆ
        float score = modelDiff * config_.modelWeight 
                    + histDiff * config_.histogramWeight;
        
        return normalizeToScore(score);
    }
    
private:
    MobileNetV3Wrapper mobileNet_;
    Config config_;
};
```

---

### 3.3.2 è¿åŠ¨æ£€æµ‹æ¨¡å—

> [!TIP]
> è¿åŠ¨æ£€æµ‹é‡‡ç”¨ YOLOv8n è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼ŒByteTrack è¿›è¡Œå¤šç›®æ ‡è·Ÿè¸ªï¼Œè®¡ç®—ç‰©ä½“ä½ç§»å¼ºåº¦ä½œä¸ºè¯„åˆ†ä¾æ®ã€‚

```mermaid
flowchart TB
    subgraph Detection["YOLOv8n ç›®æ ‡æ£€æµ‹"]
        Frame["è¾“å…¥å¸§"]
        YOLO["YOLOv8n<br/>nanoç‰ˆæœ¬"]
        Boxes["æ£€æµ‹æ¡†<br/>[x,y,w,h,cls,conf]"]
    end
    
    subgraph Tracking["ByteTrack è·Ÿè¸ª"]
        Associate["åŒˆç‰™åˆ©åŒ¹é…"]
        TrackState["è½¨è¿¹çŠ¶æ€<br/>New/Tracked/Lost"]
        TrackID["è½¨è¿¹IDåˆ†é…"]
    end
    
    subgraph Analysis["ä½ç§»åˆ†æ"]
        Center["ä¸­å¿ƒç‚¹è½¨è¿¹"]
        Velocity["é€Ÿåº¦è®¡ç®—"]
        Intensity["è¿åŠ¨å¼ºåº¦ M"]
    end
    
    Frame --> YOLO --> Boxes
    Boxes --> Associate --> TrackState --> TrackID
    TrackID --> Center --> Velocity --> Intensity
```

#### è¿åŠ¨å¼ºåº¦è®¡ç®—

```cpp
class MotionDetector {
public:
    struct TrackInfo {
        int trackId;
        cv::Point2f center;
        cv::Point2f velocity;
        float confidence;
    };
    
    float calculateScore(const Frame& frame, FrameContext& ctx) {
        // 1. YOLOv8n ç›®æ ‡æ£€æµ‹
        auto detections = yolov8_.detect(frame);
        
        // 2. ByteTrack å¤šç›®æ ‡è·Ÿè¸ª
        auto tracks = byteTrack_.update(detections);
        
        // 3. è®¡ç®—è¿åŠ¨å¼ºåº¦
        float totalMotion = 0.0f;
        float maxConfidence = 0.0f;
        
        for (const auto& track : tracks) {
            // ä½ç§»å¼ºåº¦ = é€Ÿåº¦ Ã— ç½®ä¿¡åº¦
            float displacement = cv::norm(track.velocity);
            float weightedMotion = displacement * track.confidence;
            totalMotion += weightedMotion;
            maxConfidence = std::max(maxConfidence, track.confidence);
        }
        
        // 4. å½’ä¸€åŒ–è¯„åˆ†
        float motionScore = std::min(totalMotion / motionThreshold_, 1.0f);
        
        // 5. ç½®ä¿¡åº¦åŠ æƒ
        return motionScore * 0.7f + maxConfidence * 0.3f;
    }
    
private:
    YOLOv8nWrapper yolov8_;
    ByteTracker byteTrack_;
    float motionThreshold_ = 100.0f;  // åƒç´ /å¸§
};
```

---

### 3.3.3 æ–‡å­—æ£€æµ‹æ¨¡å—

> [!IMPORTANT]
> æ–‡å­—æ£€æµ‹æ˜¯**æ ¸å¿ƒè¯­ä¹‰ä½**ï¼Œç›´æ¥å†³å®šå¸§çš„ä¿¡æ¯ä»·å€¼ã€‚PP-OCRv4 æä¾›ç«¯åˆ°ç«¯çš„æ–‡å­—å®šä½ä¸è¯†åˆ«èƒ½åŠ›ã€‚

```mermaid
flowchart TB
    subgraph OCRPipeline["PP-OCRv4 Pipeline"]
        Frame["è¾“å…¥å¸§"]
        Det["æ–‡å­—æ£€æµ‹æ¨¡å‹<br/>DB++"]
        Boxes["æ–‡å­—åŒºåŸŸ"]
        Cls["æ–¹å‘åˆ†ç±»<br/>0Â°/180Â°"]
        Rec["æ–‡å­—è¯†åˆ«<br/>SVTR"]
        Text["è¯†åˆ«ç»“æœ<br/>[text, conf, box]"]
    end
    
    subgraph Analysis["è¯­ä¹‰åˆ†æ"]
        ConfAvg["å¹³å‡ç½®ä¿¡åº¦"]
        Density["æ–‡å­—å¯†åº¦<br/>area_ratio"]
        Semantic["è¯­ä¹‰ä»·å€¼è¯„ä¼°"]
    end
    
    subgraph Score["è¯„åˆ†è¾“å‡º"]
        Final["OCRè¯„åˆ† T"]
    end
    
    Frame --> Det --> Boxes --> Cls --> Rec --> Text
    Text --> ConfAvg & Density
    ConfAvg & Density --> Semantic --> Final
```

#### æ–‡å­—å¯†åº¦ä¸ç½®ä¿¡åº¦è¯„åˆ†

```cpp
class TextDetector {
public:
    struct OCRResult {
        std::string text;
        float confidence;
        cv::Rect boundingBox;
    };
    
    float calculateScore(const Frame& frame) {
        // 1. PP-OCRv4 ç«¯åˆ°ç«¯è¯†åˆ«
        auto results = paddleOCR_.recognize(frame);
        
        if (results.empty()) {
            return 0.0f;  // æ— æ–‡å­—
        }
        
        // 2. è®¡ç®—æ–‡å­—åŒºåŸŸæ€»é¢ç§¯
        float totalTextArea = 0.0f;
        float totalConfidence = 0.0f;
        
        for (const auto& result : results) {
            totalTextArea += result.boundingBox.area();
            totalConfidence += result.confidence;
        }
        
        float frameArea = frame.width() * frame.height();
        
        // 3. æ–‡å­—å¯†åº¦ (é¢ç§¯å æ¯”)
        float density = totalTextArea / frameArea;
        float densityScore = std::min(density / 0.3f, 1.0f);  // 30%é¥±å’Œ
        
        // 4. å¹³å‡ç½®ä¿¡åº¦
        float avgConfidence = totalConfidence / results.size();
        
        // 5. èåˆè¯„åˆ†
        return densityScore * 0.6f + avgConfidence * 0.4f;
    }
    
private:
    PaddleOCRWrapper paddleOCR_;
};
```

---

## ç»¼åˆè¯„åˆ†è®¡ç®—

### åŠ¨æ€æƒé‡ç­–ç•¥

> [!NOTE]
> ä¸å›ºå®šæƒé‡ä¸åŒï¼Œæ–°æ–¹æ¡ˆé‡‡ç”¨**åŠ¨æ€æƒé‡**ï¼šæ ¹æ®å„ç»´åº¦çš„æ¿€æ´»ç¨‹åº¦è‡ªé€‚åº”è°ƒæ•´æƒé‡åˆ†é…ã€‚

```mermaid
flowchart LR
    subgraph Inputs["ç»´åº¦åˆ†æ•°"]
        S["åœºæ™¯å˜åŒ– S"]
        M["è¿åŠ¨å¼ºåº¦ M"]
        T["æ–‡å­—å¯†åº¦ T"]
    end
    
    subgraph Weights["åŠ¨æ€æƒé‡è®¡ç®—"]
        Normalize["åˆ†æ•°å½’ä¸€åŒ–"]
        Softmax["Softmax<br/>æƒé‡åˆ†é…"]
        W["åŠ¨æ€æƒé‡<br/>[ws, wm, wt]"]
    end
    
    subgraph Base["åŸºç¡€æƒé‡"]
        Ws["åœºæ™¯åŸºç¡€ 0.25"]
        Wm["è¿åŠ¨åŸºç¡€ 0.25"]
        Wt["æ–‡å­—åŸºç¡€ 0.50"]
    end
    
    subgraph Final["æœ€ç»ˆè¯„åˆ†"]
        Fusion["åŠ æƒèåˆ"]
        Score["Final Score"]
    end
    
    S & M & T --> Normalize --> Softmax --> W
    W --> Fusion
    Ws & Wm & Wt --> Fusion
    S & M & T --> Fusion --> Score
```

### è¯„åˆ†å…¬å¼

```
# åŸºç¡€æƒé‡
base_weights = [0.25, 0.25, 0.50]  # Scene, Motion, OCR

# åŠ¨æ€è°ƒæ•´å› å­
activation = softmax([S, M, T])
adjusted_weights = base_weights * (1 + Î± * activation)
adjusted_weights = normalize(adjusted_weights)

# æœ€ç»ˆè¯„åˆ†
FinalScore = S Ã— w_s + M Ã— w_m + T Ã— w_t
```

---

## ç±»è®¾è®¡æ¶æ„

```mermaid
classDiagram
    class FrameAnalyzer {
        <<interface>>
        +analyze(frame, context) float
        +getBaseWeight() float
        +getName() string
    }
    
    class SceneChangeDetector {
        -MobileNetV3Wrapper mobileNet
        -Config config
        +analyze(frame, context) float
        +extractFeature(frame) vector~float~
    }
    
    class MotionDetector {
        -YOLOv8nWrapper yolov8
        -ByteTracker byteTrack
        +analyze(frame, context) float
        +getActiveTracks() vector~TrackInfo~
    }
    
    class TextDetector {
        -PaddleOCRWrapper paddleOCR
        +analyze(frame, context) float
        +getTextResults() vector~OCRResult~
    }
    
    class KeyFrameSelector {
        -vector~FrameAnalyzer*~ analyzers
        -DynamicWeightCalculator weightCalc
        +selectKeyFrames(videoPath) vector~int~
        -preFilter(frames) vector~Frame~
        -calculateFinalScore(scores) float
    }
    
    class ModelManager {
        -map~string,Model~ models
        +loadModel(name, path) bool
        +getModel(name) Model*
        +warmUp() void
    }
    
    FrameAnalyzer <|.. SceneChangeDetector
    FrameAnalyzer <|.. MotionDetector
    FrameAnalyzer <|.. TextDetector
    KeyFrameSelector o-- FrameAnalyzer
    KeyFrameSelector --> ModelManager
    SceneChangeDetector --> ModelManager
    MotionDetector --> ModelManager
    TextDetector --> ModelManager
```

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### å¤šçº§ä¼˜åŒ–æ–¹æ¡ˆ

```mermaid
flowchart TB
    subgraph L1["Level 1: é¢„ç­›é€‰"]
        FastSkip["å¿«é€Ÿç›´æ–¹å›¾é¢„ç­›é€‰<br/>è·³è¿‡é™æ€å¸§ (ç›¸ä¼¼åº¦>0.98)"]
        Reduce["å€™é€‰å¸§å‡å°‘ ~40%"]
    end
    
    subgraph L2["Level 2: æ‰¹å¤„ç†"]
        Batch["æ‰¹é‡æ¨ç†<br/>batch_size=8"]
        Async["å¼‚æ­¥è§£ç  + æ¨ç†"]
    end
    
    subgraph L3["Level 3: ç¡¬ä»¶åŠ é€Ÿ"]
        ONNX["ONNX Runtime<br/>CPU/CUDA"]
        TensorRT["TensorRT<br/>FP16/INT8é‡åŒ–"]
    end
    
    subgraph L4["Level 4: æ¨¡å‹ä¼˜åŒ–"]
        Prune["æ¨¡å‹å‰ªæ"]
        Quantize["é‡åŒ–å‹ç¼©"]
        Cache["ç‰¹å¾ç¼“å­˜"]
    end
    
    L1 --> L2 --> L3 --> L4
```

### é¢„æœŸæ€§èƒ½æŒ‡æ ‡

| è§†é¢‘æ—¶é•¿ | åŸå§‹å¸§æ•° | é¢„ç­›é€‰å | å¤„ç†æ—¶é—´ (CPU) | å¤„ç†æ—¶é—´ (GPU) |
|:--------:|:--------:|:--------:|:--------------:|:--------------:|
| 1 åˆ†é’Ÿ | 60 | ~36 | ~5 ç§’ | ~1 ç§’ |
| 5 åˆ†é’Ÿ | 300 | ~180 | ~20 ç§’ | ~4 ç§’ |
| 15 åˆ†é’Ÿ | 900 | ~540 | ~60 ç§’ | ~12 ç§’ |
| 1 å°æ—¶ | 3600 | ~2160 | ~240 ç§’ | ~50 ç§’ |

---

## æ¨¡å‹éƒ¨ç½²è§„æ ¼

### æ¨¡å‹æ¸…å•

| æ¨¡å‹ | ç‰ˆæœ¬ | è¾“å…¥å°ºå¯¸ | æ¨¡å‹å¤§å° | æ¨ç†æ¡†æ¶ |
|:----:|:----:|:--------:|:--------:|:--------:|
| MobileNetV3-Small | v3 | 224Ã—224 | ~2.5 MB | ONNX |
| YOLOv8n | 8.0 | 640Ã—640 | ~6.3 MB | ONNX/TensorRT |
| PP-OCRv4 Det | v4 | åŠ¨æ€ | ~4.4 MB | PaddleInference |
| PP-OCRv4 Rec | v4 | åŠ¨æ€ | ~10.5 MB | PaddleInference |

### ä¾èµ–é¡¹

```plaintext
# æ¨ç†æ¡†æ¶
- ONNX Runtime >= 1.17.0
- PaddlePaddle >= 2.6.0 (å¯é€‰, ç”¨äºåŸç”Ÿæ¨ç†)
- TensorRT >= 8.6 (å¯é€‰, GPUåŠ é€Ÿ)

# C++ åº“
- OpenCV >= 4.8.0
- Eigen >= 3.4.0
```

---

## é£é™©ä¸ç¼“è§£æªæ–½

> [!WARNING]
> æ¨¡å‹é©±åŠ¨æ–¹æ¡ˆå¼•å…¥æ–°çš„å¤æ‚æ€§ï¼Œéœ€å…³æ³¨ä»¥ä¸‹é£é™©ã€‚

| é£é™©é¡¹ | ä¸¥é‡ç¨‹åº¦ | ç¼“è§£æªæ–½ |
|:------:|:--------:|:---------|
| GPU ä¸å¯ç”¨ | ä¸­ | æä¾› CPU å›é€€æ¨¡å¼ï¼Œç‰ºç‰²é€Ÿåº¦ä¿è¯åŠŸèƒ½ |
| æ¨¡å‹åŠ è½½æ…¢ | ä½ | åº”ç”¨å¯åŠ¨æ—¶é¢„åŠ è½½ï¼Œæ”¯æŒæ‡’åŠ è½½ |
| å†…å­˜å ç”¨é«˜ | ä¸­ | æ¨¡å‹å…±äº«ã€ç‰¹å¾ç¼“å­˜ã€åŠæ—¶é‡Šæ”¾ |
| OCR è€—æ—¶é•¿ | ä¸­ | ä»…å¯¹å€™é€‰å¸§æ‰§è¡Œ OCRï¼Œé¢„ç­›é€‰å‡è´Ÿ |
| æ¨¡å‹ç‰ˆæœ¬å…¼å®¹ | ä½ | å›ºå®šæ¨¡å‹ç‰ˆæœ¬ï¼Œæä¾›ç‰ˆæœ¬æ£€æŸ¥ |

---

## æ€»ç»“

æœ¬æ¶æ„é€šè¿‡å¼•å…¥æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå°†å…³é”®å¸§é€‰æ‹©ä»**åƒç´ çº§æ¯”è¾ƒ**å‡çº§ä¸º**è¯­ä¹‰çº§ç†è§£**ï¼š

1. **åœºæ™¯å˜åŒ–** - MobileNetV3-Small æå–æ·±åº¦ç‰¹å¾ï¼Œç†è§£åœºæ™¯å˜åŒ–
2. **è¿åŠ¨æ£€æµ‹** - YOLOv8n + ByteTrack å®ç°ç›®æ ‡çº§è¿åŠ¨è·Ÿè¸ª
3. **æ–‡å­—æ£€æµ‹** - PP-OCRv4 ç«¯åˆ°ç«¯è¯†åˆ«ï¼Œç²¾ç¡®è¯„ä¼°ä¿¡æ¯å¯†åº¦

é…åˆ**åŠ¨æ€æƒé‡ç­–ç•¥**å’Œ**å¤šçº§ä¼˜åŒ–**ï¼Œåœ¨ä¿æŒå®æ—¶æ€§çš„åŒæ—¶ï¼Œå®ç°æ›´ç²¾å‡†çš„å…³é”®å¸§ç­›é€‰ï¼Œé¢„æœŸå°†ä¿¡æ¯ä¿ç•™ç‡æå‡ **15-20%**ã€‚
